{
  "nodes": [
    {
      "id": "1",
      "type": "start",
      "action": "kubectl get pods",
      "if_statement": "是否有任何 Pod 处于 PENDING 状态？检查是否有 Pod 在等待资源分配或调度。",
      "true_transition": "2",
      "false_transition": "6"
    },
    {
      "id": "2",
      "type": "intermediate",
      "action": " kubectl describe pod <pod-name>",
      "if_statement": "检查集群是否已满？判断当前集群的资源是否已经耗尽，无法调度新的 Pod。",
      "true_transition": "3",
      "false_transition": "4"
    },
    {
      "id": "3",
      "type": "end",
      "action": "集群资源已满， 需要提供更大的集群来保证Pod的正常运行",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "4",
      "type": "intermediate",
      "action": "检查 ResourceQuota 限制",
      "if_statement": "是否触发了 ResourceQuota 限制？确认是否超出了命名空间的资源配额。",
      "true_transition": "5",
      "false_transition": "7"
    },
    {
      "id": "5",
      "type": "end",
      "action": "放宽 ResourceQuota 限制",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "6",
      "type": "intermediate",
      "action": "",
      "if_statement": "Pods 是否在运行状态？检查所有 Pod 是否成功启动并处于 RUNNING 状态。",
      "true_transition": "9",
      "false_transition": "22"
    },
    {
      "id": "7",
      "type": "intermediate",
      "action": "kubectl get pvc & kubectl describe pvc <pvc-name>",
      "if_statement": "是否正在挂载一个处于 PENDING 状态的 PersistentVolumeClaim？",
      "true_transition": "23",
      "false_transition": "24"
    },
    {
      "id": "8",
      "type": "intermediate",
      "action": "修复应用中的问题",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "9",
      "type": "intermediate",
      "action": "检查 Pods 是否处于 READY 状态？",
      "if_statement": "Pods 是否已就绪？检查是否容器都通过了就绪探针（Readiness Probe）的检查。",
      "true_transition": "39",
      "false_transition": "11"
    },
    {
      "id": "10",
      "type": "intermediate",
      "action": "kubectl logs <pod-name> --previous",
      "if_statement": "容器是否过快退出？检查容器是否在启动后迅速崩溃并退出。",
      "true_transition": "22",
      "false_transition": "13"
    },
    {
      "id": "11",
      "type": "intermediate",
      "action": "kubectl describe pod <pod-name>",
      "if_statement": "Readiness probe 是否失败？确定容器是否由于就绪探针失败而未能就绪。",
      "true_transition": "12",
      "false_transition": "38"
    },
    {
      "id": "12",
      "type": "end",
      "action": "修复集群的Readiness probe",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "13",
      "type": "intermediate",
      "action": "kubectl describe pod <pod-name>",
      "if_statement": "Pod 状态是否为 ImagePullBackOff？检查镜像是否无法拉取导致 Pod 失败。",
      "true_transition": "16",
      "false_transition": "17"
    },
    {
      "id": "14",
      "type": "intermediate",
      "action": "修复 Readiness probe",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "15",
      "type": "end",
      "action": "Pod 处于未知状态",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "16",
      "type": "intermediate",
      "action": "检查Pod中使用的镜像名称",
      "if_statement": "镜像名称是否正确？检查镜像名称是否有拼写错误或配置错误。",
      "true_transition": "27",
      "false_transition": "21"
    },
    {
      "id": "17",
      "type": "intermediate",
      "action": "检查 Pod 是否处于 CrashLoopBackOff 状态",
      "if_statement": "Pod 状态是否为 CrashLoopBackOff？检查容器是否不断重启并进入 CrashLoopBackOff 状态。",
      "true_transition": "32",
      "false_transition": "18"
    },
    {
      "id": "18",
      "type": "intermediate",
      "action": "检查 Pod 是否处于 RunContainerError 的状态",
      "if_statement": "Pod 状态是否为 CrashLoopBackOff？检查容器是否不断重启并进入 CrashLoopBackOff 状态。",
      "true_transition": "19",
      "false_transition": "20"
    },
    {
      "id": "19",
      "type": "end",
      "action": "问题可能出在挂载卷上。",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "20",
      "type": "end",
      "action": "请你咨询 StackOverflow",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "21",
      "type": "end",
      "action": "修复镜像的名称",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "22",
      "type": "intermediate",
      "action": "kubectl logs <pod-name>",
      "if_statement": "是否能查看应用的日志？判断是否可以通过日志诊断应用的问题。",
      "true_transition": "8",
      "false_transition": "10"
    },
    {
      "id": "23",
      "type": "intermediate",
      "action": "修复 PersistentVolumeClaim",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "24",
      "type": "intermediate",
      "action": "kubectl get pods -o wide",
      "if_statement": "检查 Pod 是否被正确分配到节点。",
      "true_transition": "26",
      "false_transition": "25"
    },
    {
      "id": "25",
      "type": "end",
      "action": "调度器 Scheduler 问题",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "26",
      "type": "end",
      "action": "Kubelet 可能存在问题",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "27",
      "type": "intermediate",
      "action": "检查镜像的标签是否是有效的？镜像的标签是否存在？",
      "if_statement": "检查镜像的标签是否是有效的？镜像的标签是否存在？",
      "true_transition": "29",
      "false_transition": "28"
    },
    {
      "id": "28",
      "type": "end",
      "action": "修复镜像的Tag标签",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "29",
      "type": "intermediate",
      "action": "是否是从私有镜像处拉取镜像？",
      "if_statement": "是否是从私有镜像处拉取镜像？",
      "true_transition": "30",
      "false_transition": "31"
    },
    {
      "id": "30",
      "type": "end",
      "action": "你需要重新配置你的镜像，出错的原因是拉取一个私有的镜像",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "31",
      "type": "end",
      "action": "问题可能出在 CRI 或 Kubelet 上。",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "32",
      "type": "intermediate",
      "action": "你检查了日志并修复了崩溃的应用吗？",
      "if_statement": "你检查了日志并修复了崩溃的应用吗？",
      "true_transition": "34",
      "false_transition": "33"
    },
    {
      "id": "33",
      "type": "intermediate",
      "action": "修复崩溃的应用",
      "if_statement": "你是否查看了日志并修复了崩溃的应用？检查是否通过日志找到并解决了应用中的问题。",
      "true_transition": "20",
      "false_transition": "21"
    },
    {
      "id": "34",
      "type": "intermediate",
      "action": "检查DockerFile是否存在问题",
      "if_statement": "DockerFile存在问题？",
      "true_transition": "35",
      "false_transition": "36"
    },
    {
      "id": "35",
      "type": "end",
      "action": "你是否忘记了在 Dockerfile 中加入 CMD 指令？检查 Dockerfile 配置是否正确，尤其是 CMD 指令。",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "36",
      "type": "intermediate",
      "action": "检查Pod 是否快速且经常重启？在Running 和 CashLoopBackoff 两个状态之间反复切换？",
      "if_statement": "检查Pod 是否快速且经常重启？在Running 和 CashLoopBackoff 两个状态之间反复切换？",
      "true_transition": "37",
      "false_transition": "38"
    },
    {
      "id": "37",
      "type": "end",
      "action": "修复 liveness probe",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "38",
      "type": "end",
      "action": "这是一个未知错误",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "39",
      "type": "intermediate",
      "action": "kubectl port-forward <pod-name> 8080:<pod-port> && curl 8080",
      "if_statement": "你是否能访问到app?",
      "true_transition": "40",
      "false_transition": "41"
    },
    {
      "id": "40",
      "type": "end",
      "action": "Pod 没有任何异常！",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "41",
      "type": "end",
      "action": "可能是网络异常",
      "if_statement": null,
      "true_transition": null,
      "false_transition": null
    },
    {
      "id": "42",
      "type": "intermediate",
      "action": "kubectl describe pod <pod-name>",
      "if_statement": "Readiness probe 是否失败？确定容器是否由于就绪探针失败而未能就绪。",
      "true_transition": "14",
      "false_transition": "15"
    }
  ]
}
